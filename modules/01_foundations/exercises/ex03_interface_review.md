# ex03_interface_review â€“ API hygiene pass

What you are building: small refactors to clarify ownership and includes.
Why it matters: Large codebases need stable, readable interfaces.

Prerequisites check
- `clang-tidy --version` (expect version output; install via `sudo apt install clang-tidy` if missing)

Files you will touch
- `include/platform/pipeline.hpp`
- `src/platform/pipeline.cpp`

Steps
1. Add forward declarations instead of includes where possible. Inspect header:
```
sed -n '1,120p' include/platform/pipeline.hpp
```
Remove unnecessary includes (keep <atomic>, <string>, etc.).

2. Add comment describing ownership rules for `MessageBus` reference returned by `bus()`.

3. Run clang-tidy on pipeline only:
```
cmake --build --preset dev --target platform_core_app
clang-tidy src/platform/pipeline.cpp -- -Iinclude -std=c++20
```
Expected: 0 warnings after adjustments.

Verification
- `ctest --preset dev -R Pipeline` (none yet; ensure existing tests still pass: `ctest --preset dev`)
- clang-tidy reports 0 warnings for file.

Stop here and commit
- Message: "Module01: pipeline interface hygiene"

If it fails
- clang-tidy command complains about compile commands: ensure `build/dev/compile_commands.json` exists (generated by CMake).
- Missing include leads to compile error: re-add minimal include.

Stretch goals
- Add short docblock explaining pipeline stage threading model.
